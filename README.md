# Условие задачи

> Известный художник решил написать новый шедевр. После многих дней усердной работы он захотел исследовать свое творение. Художник вспомнил, что картина писалась следующим образом: сначала был взят белый холст, имеющий форму прямоугольника шириной w и высотой h. Затем художник нарисовал на этом холсте n прямоугольников со сторонами, параллельными сторонам холста и вершинами, расположенными в целочисленных координатах. Помогите художнику определить площадь незакрашенной части холста.  

**Входные данные**

> Первая строка входного файла INPUT.TXT содержит два натуральных числа w и h (1 ≤ w, h ≤ 100). Во второй строке записано целое число n (0 ≤ n ≤ 5000) – количество прямоугольников. Следующие n строк содержат информацию о всех прямоугольниках. Каждая строка описывает один прямоугольник в виде четырех чисел x1, y1, x2, y2 , где (x1, y1) и (x2, y2) – координаты левого верхнего и правого нижнего угла прямоугольника соответственно.  

# Вариант решения

Разбор задачи на Reddit  [https://www.reddit.com/comments/zaa0v](https://www.reddit.com/comments/zaa0v).  
Адаптировал под случай который указан в условии:
прямоугольник определяется значениями (x1, y1, x2, y2), где (x1, y1) - верхний левый угол, (x2, y2) - правый нижний угол. 
```
x1,y1───────────┐
    │           │
    │           │
    │           │
    │           │
    └───────────x2,y2
```
Алгоритм слудующий: находим сумму площадей всех прямоугольников и эту сумму вычитаем из площади полотна. 
Площадь прямоугольника, в нашем случае, равна  (x2 - x1) * (y1 - y2). 

#### Случай 1. Прямоугольники не пересекаются.
```
    Прямоугольники (0,3,4,0), (4,7,7,3) и (7,3,10,0) будут выглядеть примерно так:
        * * * 
        * * * 
        * * *
        * * *
* * * *       * * *
* * * *       * * *
* * * *       * * *
```
Общая площадь этих трех прямоугольников проста для вычисления, это всего лишь сумма площадей каждого отдельного прямоугольника: (4 * 3) + (3 * 4) + (3 * 3)

#### Случай 2. Прямоугольники пересекаются, общее пересечение имеют 2 прямоугольника.
```
    Рассмотрим три прямоугольника (0,3,4,0), (2,5,5,1) и (4,7,7,4):
        * * * 
        * * * 
    * * + * * 
    * * *     
* * + + *      
* * + + *      
* * * *  
```
Вы видите, что прямоугольники пересекаются (области, где они пересекаются, отмечены символом "+" вместо "*"). Поэтому, если мы просто вычислим сумму площадей, как мы делали раньше, 12 + 12 + 9, мы получим слишком большое значение (33 вместо 28), потому что мы рассчитываем области с пересечением дважды.  
Чтобы получить правильный ответ, мы должны вычесть области, в которых пересекаются два прямоугольника: (12 + 12 + 9) - (4 + 1) = 28.  

#### Случай 3. Общее пересечение имеют сразу несколько прямоугольников.
```
    Рассмотрим прямоугольники (0,3,4,0), (2,5,5,1) и (3,3,6,0)
    * * *
    * * *     
* * + x + *      
* * + x + *   
* * * + * *   
```
Теперь три прямоугольника перекрываются в точках, отмеченных символом "x" (как и раньше, знак "+", где перекрываются только два прямоугольника).  Сумма площадей всех трех треугольников: 12 + 12 + 9. Затем мы должны вычесть сумму всех площадей, где пересекаются два прямоугольника 4 + 3 + 4 (прямоугольники 1 и 2 пересекаются в области с площадью 4, прямоугольники 1 и 3 пересекаются в области с площадью 3, и прямоугольники 2 и 3 пересекаются в области с площадью 4). Мы получили (12 + 12 + 9) - (4 + 3 + 4).  
Однако, вычитая все области пересечения двух прямоугольников, мы вычитаем область, в которой три прямоугольника пересекаются (обозначено "x"), три раза.  Поэтому мы должны добавить площадь пересечения трех прямоугольников, чтобы получить правильный результат. Таким образом, общая площадь, покрытая прямоугольниками:
```
A = (12 + 12 + 9) - (4 + 3 + 4) + (2) = 33 - 11 + 2 = 24
```
   Общее правило, на самом деле, довольно простое. Если S1 - сумма площадей всех прямоугольников, S2 - сумма всех областей, где пересекаются два прямоугольника, S3 - сумма всех областей, где пересекаются три прямоугольника, S4 - сумма всех областей, где пересекаются четыре прямоугольника и т.д., значение общей площади равно:  
```
    A = S1 - S2 + S3 - S4 + S5 - S6 + S7 - S8 + ...
```
Это известно в математике как [принцип включений-исключений](https://ru.wikipedia.org/wiki/%D0%A4%D0%BE%D1%80%D0%BC%D1%83%D0%BB%D0%B0_%D0%B2%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B9-%D0%B8%D1%81%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B9), потому что вы чередуете включение и исключение областей. Значения в нашем примере соответствуют:
```
    S1 = 12 + 12 + 9 
    S2 = 4 + 3 + 4  
    S3 = 2
```

# Запуск тестов
В репозитории находится скрипт для запуска тестов ```test_rectangles_area.py```. 
Набор тестов включает в себя следующие тесты:  
- вычисление площади для случая если прямоугольник один;
- вычисление площади когда прямоугольники не пересекаются;
- вычисление площади когда прямоугольники не пересекаются, но общее пересечение имеют 2 прямоугольника;
- вычисление площади когда прямоугольники не пересекаются,но общее пересечение имеют сразу несколько прямоугольников. 

Пример запуска тесов в OC Linux(Debian):

```
 $ python test_rectangles_area.py -v
test_multiple_overlapping_rectangles_area (__main__.RectanglesAreaTest) ... ok
test_non_intersecting_rectanles_area (__main__.RectanglesAreaTest) ... ok
test_overlapping_rectangles_area (__main__.RectanglesAreaTest) ... ok
test_rectangle_area (__main__.RectanglesAreaTest) ... ok

----------------------------------------------------------------------
Ran 4 tests in 0.001s

OK
```

# Цели проекта

Код написан для [https://toster.ru/q/555262#answer_1264094](https://toster.ru/q/555262#answer_1264094)